server {
    # Ouve na porta 80 (HTTP)
    listen 80;
    
    # O nome do seu domínio ou endereço IP
    server_name meu-dominio.com www.meu-dominio.com;
    
    # Diretório raiz dos seus arquivos web (Ajuste este caminho)
    root /var/www/meusite/public;
    
    # Adiciona o index.php como um arquivo de índice válido.
    index index.php index.html index.htm;

    # Bloco principal para lidar com requisições
    location / {
        # Tenta servir o arquivo (URI) ou o diretório diretamente.
        # Se nenhum for encontrado, passa a requisição para index.php com os argumentos (útil para frameworks como Laravel/Symfony).
        try_files $uri $uri/ /index.php?$args;
    }

    # Bloco para processar arquivos PHP
    location ~ \.php$ {
        # Tenta encontrar o arquivo. Se não existir, retorna 404.
        try_files $uri =404;
        
        # O socket que o PHP-FPM está ouvindo (ajuste a versão do PHP, se necessário)
        # Para PHP 8.2 em Ubuntu/Debian:
        fastcgi_pass unix:/run/php/php8.2-fpm.sock;
        
        # Habilita FastCGI
        include fastcgi_params;
        
        # Define o SCRIPT_FILENAME para o PHP-FPM saber qual arquivo executar
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        
        # Desativa a verificação de existência do arquivo no PHP-FPM (segurança)
        fastcgi_intercept_errors on;
    }
    
    # Opcional: Bloco para negar acesso a arquivos de configuração/ocultos
    location ~ /\.ht {
        deny all;
    }
    
    # Opcional: Bloco para desabilitar a execução de scripts PHP em diretórios de uploads
    # Isso melhora a segurança contra uploads maliciosos.
    # location ~* /(?:uploads|files)/.*\.php$ {
    #     deny all;
    # }
}